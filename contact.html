<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Video Player</title>

    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Bengali&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"/>
  
<style>
        *,html {
            padding: 0px;
            margin: 0px;
            box-sizing: border-box;
        }
        body{
            background-color: rgb(255, 255, 255)!important;
        }
        a, a:hover, a:active, a:link, a:visited {
  text-decoration: none !important;
  color: black;
 }

        .con {
            position: relative;
            height: auto;
            border: none;
            margin-top: 0; /* Initialize margin-top */
        }
        
.options {
    position: fixed;
    bottom: 85px;
    right: 30px;
    margin-left: 20px;
    font-size: 1em;
    flex: 1 1 calc(20% - 10px);
    min-width: 150px;
    box-sizing: border-box;
    max-width: 350px;
    min-width: 250px;

}



        
select {
  border: none;
  outline: none;
  padding: 6px 6px;
  margin-bottom: 2px;
  font-size: 16px;
  border-radius: 4px;
width: 100%;
  font-family: 'Noto Serif Bengali', serif;
  background-color: rgb(215 232 255 / 49%); 
  backdrop-filter: blur(3px); 
  -webkit-backdrop-filter: blur(3px); 
}


 select:focus {
  border: none;
  outline: none; 
}
/* Remove default styling and add custom styles for option elements */
option {
  color: #333333;
  padding: 20px;
  border-radius: 10px;
  border: none;

}

/* Optional: Custom arrow styling */
select::after {
  content: "▼"; /* Unicode for downward arrow */
  font-size: 16px;
  color: #333;
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}
        #player {
            position: relative;
        }

        .video-main-box {
            position: fixed;
            top: 0;
            width: 100%;
            margin: 0 auto;
            background-color: lightblue; /* For debugging visibility */
        }

        #video-iframe {
            height: calc((108vw) * 542 / 1038);
        }

        #content{
            font-family: 'Noto Serif Bengali', serif;
            
        }
        #content h4{
            padding: 5px 10px;
            color: #df00ad;
        }
    
        
        #content h5{
            padding: 0px 10px;
            color: #3a51ab;
        }
    
.video-list {
    list-style: none;
    padding: 0;
    display: flex;
    flex-direction: column;
    margin-top: 10px;
    margin-bottom: 20px;
    }


.video-card {
    display: flex;
    flex-direction: row;
    gap: 15px;
    padding: 10px;
    transition: background-color 0.3s ease;
    align-items: flex-start;
    font-family: 'Noto Serif Bengali', serif;

}

.video-card:hover {
    background-color: #f5f5f5;
}

.video-thumbnail {
    position: relative;
    width: 160px; /* Fixed width */
    height: 90px;  /* Fixed height for a 16:9 ratio */
    background-color: #ddd;
    overflow: hidden;
    border-radius: 5px;
    flex-shrink: 0; /* Prevents shrinking on narrow screens */
}

.video-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensures the image covers the entire thumbnail without distorting */
}

.video-duration {
    position: absolute;
    bottom: 5px;
    right: 5px;
    background-color: rgba(0, 0, 0, 0.8);
    color: #fff;
    padding: 2px 4px;
    font-size: 12px;
    border-radius: 3px;
}

.video-info {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    font-family: 'Noto Serif Bengali', serif;
    line-height: 1;

}

.video-title {
    font-size: 12px;
    font-weight: 600;
    margin: 0;
    color: #333;
    overflow: hidden; /* Hide overflow */
    text-overflow: ellipsis; /* Show ellipsis */
    display: -webkit-box; /* Use flexbox for multi-line truncation */
    -webkit-line-clamp: 2; /* Limit to 2 lines */
    -webkit-box-orient: vertical; /* Stack lines vertically */
    line-height: 1.4;
}


.video-meta {
    font-size: 12px;
    color: #555;
    margin-top: 5px;
}

.video-views, .video-year {
    color: #888;
}

.active-video {
    background-color: #e0e0e0; /* Example style for the active video */
}
/* Responsive adjustments */
@media (max-width: 768px) {
    .video-thumbnail {
        width: 90px; /* Smaller width */
        height: 50.625px;
}

}
.video-container-lesson {
    background: rgb(255, 255, 255);
    padding: 0px;
    margin: 0px;
}
    </style>
</head>
<body>
    <div class="video-main-box" style="z-index: 12;">
        <div class="video-container-lesson" id="player">
            <iframe id="video-iframe" width="100%" height="100%" src="" allowfullscreen></iframe>
        </div>
    </div>

    <div class="con">

  
        <div id="content"></div>


    </div>
<div class="options">
    <div class="select-wrapper">
        <select id="chapter-select" class="custom-select">
            <option value="">Select a Chapter</option>
        </select>
    
        <select id="playlist-select" class="custom-select" disabled>
            <option value="">Select a Teacher/Playlist</option>
        </select>
    </div>
    
</div>

<script>
    const apiKey = 'AIzaSyCoDEQJW6holKerCuynz7KgfuHJEwCieIM'; // Your API key

    const data = [
        {
            "Chapter 01": {
                "Saimon Hossain ।। কি নিদারুন আমার সিক্ষক আমি ধ্ন্য সথিতি। জত কথাই বলি এতা আমার মান্তেইহ হবেহ": {
                    "videos": ["dQw4w9WgXcQ", "9bZkp7q19f0"], // Updated video IDs
                    "image": "https://example.com/image33333333331.jpg"
                },
                "Ilias Ali": {
                    "videos": ["3JZ_D3ELwOQ", "tVj0ZTS4WF4"], // Updated video IDs
                    "image": "https://example.com/image2.jpg"
                },
                "Ilias Ali || একটু ত এদিক সেদিক হবেই": {
                    "videos": ["3JZ_D3ELwOQ", "tVj0ZTS4WF4"], // Updated video IDs
                    "image": "https://example.com/image2.jpg"
                }
            }
        },
        {
            "Chapter 02": {
                "AbC Hossain": {
                    "videos": ["dQw4w9WgXcQ", "kJQP7kiw5Fk"], // Updated video IDs
                    "image": "https://example.com/image3.jpg"
                },
                "Lijon Ilias Ali": {
                    "videos": ["3JZ_D3ELwOQ", "kJQP7kiw5Fk"], // Updated video IDs
                    "image": "https://example.com/image4.jpg"
                }
            }
        },
        {
            "Chapter 03": {
                "Saimon Hossain": {
                    "videos": ["dQw4w9WgXcQ", "L_j4Th1hA4Q"], // Updated video IDs
                    "image": "https://example.com/image5.jpg"
                },
                "Ilias Ali": {
                    "videos": ["3JZ_D3ELwOQ", "t2gAqFxx3-8"], // Updated video IDs
                    "image": "https://example.com/image6.jpg"
                }
            }
        }
    ];

    function sanitizeForClassName(text) {
        return text
            .replace(/[^a-zA-Z0-9]/g, '-') // Replace non-alphanumeric characters with a hyphen
            .replace(/-+/g, '-') // Replace multiple hyphens with a single hyphen
            .replace(/^-+|-+$/g, '') // Remove leading and trailing hyphens
            .toLowerCase(); // Convert to lowercase
    }

    function fetchVideoDetails(videoIds) {
        return Promise.all(videoIds.map(id =>
            fetch(`https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails,statistics&id=${id}&key=${apiKey}`)
                .then(response => response.json())
                .then(data => {
                    if (data.items && data.items.length > 0) {
                        return data.items[0];
                    } else {
                        console.warn(`No data found for video ID: ${id}`);
                        return null;
                    }
                })
        )).then(videos => videos.filter(video => video !== null));
    }

    function formatDuration(duration) {
        const match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
        if (match) {
            const hours = match[1] ? match[1].replace('H', '') : '';
            const minutes = match[2] ? match[2].replace('M', '') : '';
            const seconds = match[3] ? match[3].replace('S', '') : '';
            return `${hours ? hours + ':' : ''}${minutes.padStart(2, '0')}:${seconds.padStart(2, '0')}`;
        }
        return '0:00';
    }

    function formatViews(views) {
        views = parseInt(views, 10);
        if (views >= 1000000000) {
            return `${(views / 1000000000).toFixed(1)}B views`;
        } else if (views >= 1000000) {
            return `${(views / 1000000).toFixed(1)}M views`;
        } else if (views >= 1000) {
            return `${(views / 1000).toFixed(1)}K views`;
        } else {
            return `${views} views`;
        }
    }

    function displayContent(data) {
        const content = document.getElementById('content');
        content.innerHTML = ''; // Clear existing content

        data.forEach(chapter => {
            Object.keys(chapter).forEach(chapterName => {
                const chapterDiv = document.createElement('div');
                
                const chapterClass = sanitizeForClassName(chapterName);
                chapterDiv.className = `chapter ${chapterClass}`;
                chapterDiv.setAttribute('data-chapter-name', chapterName);
                
                const chapterHeader = document.createElement('h4');
                chapterHeader.textContent = chapterName;
                chapterDiv.appendChild(chapterHeader);

                Object.keys(chapter[chapterName]).forEach(playlistName => {
                    const playlist = chapter[chapterName][playlistName];
                    const playlistDiv = document.createElement('div');

                    const playlistClass = sanitizeForClassName(playlistName);
                    playlistDiv.className = `playlist ${playlistClass}`;
                    playlistDiv.setAttribute('data-teacher-name', playlistName);

                    const playlistHeader = document.createElement('h5');
                    playlistHeader.textContent = playlistName;
                    playlistDiv.appendChild(playlistHeader);

                    const playlistImage = document.createElement('img');
                    playlistImage.src = playlist.image;
                    playlistImage.style.maxWidth = '200px';
                   

                    const videoList = document.createElement('ul');
                    videoList.className = 'video-list';

                    fetchVideoDetails(playlist.videos).then(videos => {
                        videos.forEach(video => {
                            const listItem = document.createElement('li');
                            listItem.className = 'video-card'; // Add class for styling
                            listItem.setAttribute('data-video-id', video.id);

                            const thumbnailDiv = document.createElement('div');
                            thumbnailDiv.className = 'video-thumbnail';
                            const thumbnailImg = document.createElement('img');
                            thumbnailImg.src = video.snippet.thumbnails.default.url; // Get the small-sized thumbnail URL
                            thumbnailImg.alt = video.snippet.title;
                            thumbnailDiv.appendChild(thumbnailImg);

                            const durationSpan = document.createElement('span');
                            durationSpan.className = 'video-duration';
                            durationSpan.textContent = formatDuration(video.contentDetails.duration); // Format duration
                            thumbnailDiv.appendChild(durationSpan);

                            const infoDiv = document.createElement('div');
                            infoDiv.className = 'video-info';

                            const titleH3 = document.createElement('h3');
                            titleH3.className = 'video-title';
                            titleH3.textContent = video.snippet.title;
                            infoDiv.appendChild(titleH3);

                            const metaDiv = document.createElement('div');
                            metaDiv.className = 'video-meta';

                            const viewsSpan = document.createElement('span');
                            viewsSpan.className = 'video-views';
                            viewsSpan.textContent = formatViews(video.statistics.viewCount); // Format views
                            metaDiv.appendChild(viewsSpan);

                            infoDiv.appendChild(metaDiv);

                            listItem.appendChild(thumbnailDiv);
                            listItem.appendChild(infoDiv);

                            listItem.onclick = function() {
                                const videoId = this.getAttribute('data-video-id');
                                const iframe = document.getElementById('video-iframe');
                                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&iv_load_policy=3&modestbranding=1&rel=0&showinfo=0&rel=0&enablejsapi=1`;
                            };

                            videoList.appendChild(listItem);
                        });
                    });

                    playlistDiv.appendChild(videoList);
                    chapterDiv.appendChild(playlistDiv);
                });

                content.appendChild(chapterDiv);
            });
        });
    }

    displayContent(data);
</script>








<script>
    document.addEventListener('DOMContentLoaded', () => {
        const chapterSelect = document.getElementById('chapter-select');
        const playlistSelect = document.getElementById('playlist-select');
        const content = document.getElementById('content');
        const iframe = document.getElementById('video-iframe');
    
        // Sanitize function to format strings for class names and data attributes
        function sanitizeForClassName(text) {
            return text
                .replace(/[^a-zA-Z0-9]/g, '-') // Replace non-alphanumeric characters with a hyphen
                .replace(/-+/g, '-') // Replace multiple hyphens with a single hyphen
                .replace(/^-+|-+$/g, '') // Remove leading and trailing hyphens
                .toLowerCase(); // Convert to lowercase
        }
    
        // Populate chapter select
        data.forEach(chapter => {
            const chapterName = Object.keys(chapter)[0];
            const option = document.createElement('option');
            option.value = chapterName;
            option.textContent = chapterName;
            chapterSelect.appendChild(option);
        });
    
        // Update playlist select based on chapter selection
        chapterSelect.addEventListener('change', () => {
            const selectedChapter = chapterSelect.value;
            playlistSelect.innerHTML = '<option value="">Select a Teacher/Playlist</option>'; // Clear previous options
            playlistSelect.disabled = !selectedChapter; // Enable/disable based on chapter selection
    
            if (selectedChapter) {
                const chapterData = data.find(chapter => chapter[selectedChapter]);
                if (chapterData) {
                    const playlists = chapterData[selectedChapter];
                    Object.keys(playlists).forEach(playlistName => {
                        const option = document.createElement('option');
                        option.value = playlistName;
                        option.textContent = playlistName;
                        playlistSelect.appendChild(option);
                    });
    
                    // Pre-select the teacher/playlist if available in query params
                    const urlParams = new URLSearchParams(window.location.search);
                    const teacher = urlParams.get('teacher');
                    if (teacher && playlists[teacher]) {
                        playlistSelect.value = teacher;
                    }
                } else {
                    console.warn(`No data found for chapter: ${selectedChapter}`);
                }
            }
            updateURL(); // Update URL when chapter changes
        });
    
        // Update content based on selected options
        function updateContent() {
            const selectedChapter = chapterSelect.value;
            const selectedTeacher = playlistSelect.value;
    
            console.log('Selected Chapter:', selectedChapter, 'Selected Teacher:', selectedTeacher);
    
            // Hide all chapters
            content.querySelectorAll('.chapter').forEach(ch => ch.style.display = 'none');
    
            // Show the selected chapter
            if (selectedChapter) {
                const chapterDiv = content.querySelector(`.chapter[data-chapter-name="${selectedChapter}"]`);
                if (chapterDiv) {
                    chapterDiv.style.display = 'block';
    
                    // Hide all playlists within the chapter
                    chapterDiv.querySelectorAll('.playlist').forEach(pl => pl.style.display = 'none');
    
                    // Show the selected playlist
                    if (selectedTeacher) {
                        const playlistDiv = chapterDiv.querySelector(`.playlist[data-teacher-name="${selectedTeacher}"]`);
                        if (playlistDiv) {
                            playlistDiv.style.display = 'block';
    
                            // Remove active class from all video list items
                            playlistDiv.querySelectorAll('.video-list li').forEach(li => li.classList.remove('active-video'));
    
                            // Get the first video ID from the playlist
                            const firstVideo = playlistDiv.querySelector('.video-list li');
                            if (firstVideo) {
                                const videoId = firstVideo.getAttribute('data-video-id');
                                if (videoId) {
                                    iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&iv_load_policy=3&modestbranding=0&rel=0&showinfo=0&rel=0&enablejsapi=1`;
    
                                    // Add active class to the first video
                                    firstVideo.classList.add('active-video');
                                } else {
                                    console.warn('No video ID found for the selected playlist.');
                                }
                            }
                        }
                    } else {
                        // Show all playlists if no specific playlist is selected
                        chapterDiv.querySelectorAll('.playlist').forEach(pl => pl.style.display = 'block');
    
                        // Set the iframe source to the first video of the first visible playlist
                        const firstVisiblePlaylist = chapterDiv.querySelector('.playlist:not([style*="display: none"])');
                        if (firstVisiblePlaylist) {
                            const firstVideo = firstVisiblePlaylist.querySelector('.video-list li');
                            if (firstVideo) {
                                const videoId = firstVideo.getAttribute('data-video-id');
                                if (videoId) {
                                    iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&iv_load_policy=3&modestbranding=1&rel=0&showinfo=0&rel=0&enablejsapi=1`;
    
                                    // Add active class to the first video
                                    firstVideo.classList.add('active-video');
                                } else {
                                    console.warn('No video ID found for the first visible playlist.');
                                }
                            }
                        }
                    }
                }
            }
            updateURL(); // Update the URL whenever content is updated
        }
    
        // Function to update the URL with selected chapter and teacher
        function updateURL() {
            const selectedChapter = chapterSelect.value;
            const selectedTeacher = playlistSelect.value;
    
            // Construct new URL
            const urlParams = new URLSearchParams(window.location.search);
            if (selectedChapter) {
                urlParams.set('chapter', selectedChapter);
            } else {
                urlParams.delete('chapter');
            }
    
            if (selectedTeacher) {
                urlParams.set('teacher', selectedTeacher);
            } else {
                urlParams.delete('teacher');
            }
    
            const newUrl = `${window.location.pathname}?${urlParams.toString()}`;
            history.replaceState(null, '', newUrl);
        }
    
        // Add event listeners for chapter and playlist selections
        chapterSelect.addEventListener('change', updateContent);
        playlistSelect.addEventListener('change', updateContent);
    
        // Add event listener to handle video list item clicks
        content.addEventListener('click', (event) => {
            if (event.target.tagName === 'LI' && event.target.parentElement.classList.contains('video-list')) {
                // Remove active class from all video list items
                event.target.parentElement.querySelectorAll('li').forEach(li => li.classList.remove('active-video'));
    
                // Add active class to the clicked video
                event.target.classList.add('active-video');
    
                // Update iframe source
                const videoId = event.target.getAttribute('data-video-id');
                iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&iv_load_policy=3&modestbranding=1&rel=0&showinfo=0&rel=0&enablejsapi=1`;
            }
        });
    
        // Pre-select the chapter and playlist if available in query params
        const urlParams = new URLSearchParams(window.location.search);
        const chapter = urlParams.get('chapter');
        const teacher = urlParams.get('teacher');
        if (chapter) {
            chapterSelect.value = chapter;
            chapterSelect.dispatchEvent(new Event('change'));
        }
        if (teacher) {
            playlistSelect.value = teacher;
            updateContent(); // Ensure content updates based on pre-selected teacher
        }
    
        // Trigger content update on page load if no chapter/teacher is pre-selected
        if (!chapter || !teacher) {
            updateContent();
        }
    
        // Ensure iframe src is updated after DOM is fully loaded
        window.addEventListener('load', () => {
            updateContent();
        });
    });
    
    // Function to handle card clicks
    function handleCardClick(event) {
        // Find the closest element with the 'video-card' class (clicked element or its parent)
        const videoCard = event.target.closest('.video-card');
        
        if (videoCard) {
            console.log('Clicked card:', videoCard); // Debug: Show clicked card
            
            // Remove 'active-video' class from all video cards
            document.querySelectorAll('.video-card').forEach(card => {
                card.classList.remove('active-video');
            });
            
            // Add 'active-video' class to the clicked card
            videoCard.classList.add('active-video');
        } else {
            console.log('Clicked outside video card'); // Debug: Clicked outside
        }
    }
    
    document.getElementById('content').addEventListener('click', handleCardClick);
</script>
<script>
    const videoIframe = document.querySelector('.video-main-box');
    const con = document.querySelector('.con');

    function setMarginTop() {
        // Check if videoIframe and con elements exist
        if (videoIframe && con) {
            const videoHeight = videoIframe.offsetHeight;
            con.style.marginTop = `${videoHeight}px`;
            console.log('Margin Top set to:', videoHeight);
        } else {
            console.log('videoIframe or con not found');
        }
    }

    setMarginTop(); // initial setting

    window.addEventListener('resize', setMarginTop);
</script>

